import{r as i,c as F,a as H,_ as z,b as p,d as y,e as t,w as a,u as s,i as L,F as Q,f as D,g as l,o as c,h as j,j as E,k as O,t as k,l as G}from"./index-Cyiciw1a.js";function J(){const f=i(""),n=i([]),r=i();function w(){if(!f.value)return H.warning("请输入问题");r.value&&(console.log(r.value,"historyListRef.value="),r.value.scrollTop=r.value.scrollHeight),n.value.push({role:"user",content:f.value}),f.value="",x()}const d=i(!1);async function x(){try{d.value=!0,console.log(n.value,"messages");const e=await(await fetch("http://localhost:3000/getAnswer",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({messages:n.value})})).json();console.log(e),n.value.push(e.data.choices[0].message)}finally{d.value=!1}}const v=F(()=>{var u,e;return(u=n.value)!=null&&u.length?(e=n.value[0])==null?void 0:e.content:"问题"}),_=i(0),T=i([{text:"对话1",id:1,messages:[]},{text:"对话2",id:2,messages:[]}]);function g(u){_.value=u}const C=i(""),h=i(!1);function b(){h.value=!0}return{curSessionIndex:_,changeSession:g,userQuestionTxt:f,questionTxt:v,addSession:b,sendQuestion:w,visible:h,newQuestionTxt:C,loading:d,messages:n,sessionList:T}}const M={class:"ai-answer-layout"},P={class:"header"},$={key:0,class:"question"},W={key:1,class:"answer"},X={class:"question-module"},Y={class:"question-operation"},Z=D({name:"ai-answer"}),ee=Object.assign(Z,{setup(f){const{userQuestionTxt:n,curSessionIndex:r,changeSession:w,sendQuestion:d,addSession:x,newQuestionTxt:v,visible:_,messages:T,loading:g,historyListRef:C,questionTxt:h,sessionList:b}=J();return(u,e)=>{const S=l("a-button"),B=l("a-space"),I=l("a-layout-sider"),N=l("a-spin"),q=l("a-textarea"),A=l("a-layout-content"),R=l("a-layout"),K=l("a-form-item"),U=l("a-form"),V=l("a-modal");return c(),p(Q,null,[y("div",M,[t(R,{class:"layout"},{default:a(()=>[t(R,{class:"content-layout"},{default:a(()=>[t(I,{class:"side"},{default:a(()=>[t(B,{direction:"vertical",style:{width:"100%"}},{default:a(()=>[(c(!0),p(Q,null,j(s(b),(o,m)=>(c(),E(S,{key:m,type:s(r)===m?"primary":"default",style:{width:"100%"},onClick:te=>s(w)(m)},{default:a(()=>[O(k(o.text),1)]),_:2},1032,["type","onClick"]))),128)),t(S,{style:{width:"100%"},type:"dashed",onClick:s(x)},{default:a(()=>e[3]||(e[3]=[O("新增对话")])),_:1},8,["onClick"])]),_:1})]),_:1}),t(A,{class:"content"},{default:a(()=>[y("div",P,k(s(h)),1),y("div",{class:"history-answer-module",ref_key:"historyListRef",ref:C},[(c(!0),p(Q,null,j(s(T),(o,m)=>(c(),p("div",{key:m},[o.role!=="assistant"?(c(),p("div",$,k(o.content),1)):(c(),p("div",W,k(o.content),1))]))),128)),t(N,{spinning:s(g)},null,8,["spinning"])],512),y("div",X,[y("div",Y,[t(q,{value:s(n),"onUpdate:value":e[0]||(e[0]=o=>L(n)?n.value=o:null),valueModifiers:{trim:!0},placeholder:"请输入问题后点击发送或者回车进行搜索",rows:3,onKeydown:G(s(d),["enter"])},null,8,["value","onKeydown"]),t(S,{loading:s(g),size:"large",onClick:s(d),type:"primary",class:"btn"},{default:a(()=>e[4]||(e[4]=[O("发送")])),_:1},8,["loading","onClick"])])])]),_:1})]),_:1})]),_:1})]),t(V,{open:s(_),"onUpdate:open":e[2]||(e[2]=o=>L(_)?_.value=o:null),title:"新增会话",onOk:u.handleOk,okText:"确定",cancelText:"取消"},{default:a(()=>[t(U,null,{default:a(()=>[t(K,{label:"问题描述"},{default:a(()=>[t(q,{value:s(v),"onUpdate:value":e[1]||(e[1]=o=>L(v)?v.value=o:null),placeholder:"请输入问题"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["open","onOk"])],64)}}}),ne=z(ee,[["__scopeId","data-v-c52dee7e"]]);export{ne as default};
